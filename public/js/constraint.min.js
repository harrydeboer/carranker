"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _TetherBase$Utils=TetherBase.Utils,getBounds=_TetherBase$Utils.getBounds,extend=_TetherBase$Utils.extend,updateClasses=_TetherBase$Utils.updateClasses,defer=_TetherBase$Utils.defer;var BOUNDS_FORMAT=["left","top","right","bottom"];function getBoundingRect(tether,to){if(to==="scrollParent"){to=tether.scrollParents[0]}else if(to==="window"){to=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]}if(to===document){to=to.documentElement}if(typeof to.nodeType!=="undefined"){var node=to;var size=getBounds(to);var pos=size;var style=getComputedStyle(to);to=[pos.left,pos.top,size.width+pos.left,size.height+pos.top];if(node.ownerDocument!==document){var win=node.ownerDocument.defaultView;to[0]+=win.pageXOffset;to[1]+=win.pageYOffset;to[2]+=win.pageXOffset;to[3]+=win.pageYOffset}BOUNDS_FORMAT.forEach(function(side,i){side=side[0].toUpperCase()+side.substr(1);if(side==="Top"||side==="Left"){to[i]+=parseFloat(style["border"+side+"Width"])}else{to[i]-=parseFloat(style["border"+side+"Width"])}})}return to}TetherBase.modules.push({position:function position(_ref){var _this=this;var top=_ref.top,left=_ref.left,targetAttachment=_ref.targetAttachment;if(!this.options.constraints){return true}var _cache=this.cache("element-bounds",function(){return getBounds(_this.element)}),height=_cache.height,width=_cache.width;if(width===0&&height===0&&typeof this.lastSize!=="undefined"){var _lastSize=this.lastSize;width=_lastSize.width;height=_lastSize.height}var targetSize=this.cache("target-bounds",function(){return _this.getTargetBounds()});var targetHeight=targetSize.height,targetWidth=targetSize.width;var allClasses=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(constraint){var outOfBoundsClass=constraint.outOfBoundsClass,pinnedClass=constraint.pinnedClass;if(outOfBoundsClass){allClasses.push(outOfBoundsClass)}if(pinnedClass){allClasses.push(pinnedClass)}});allClasses.forEach(function(cls){["left","top","right","bottom"].forEach(function(side){allClasses.push(cls+"-"+side)})});var addClasses=[];var tAttachment=extend({},targetAttachment);var eAttachment=extend({},this.attachment);this.options.constraints.forEach(function(constraint){var to=constraint.to,attachment=constraint.attachment,pin=constraint.pin;if(typeof attachment==="undefined"){attachment=""}var changeAttachX=void 0,changeAttachY=void 0;if(attachment.indexOf(" ")>=0){var _attachment$split=attachment.split(" ");var _attachment$split2=_slicedToArray(_attachment$split,2);changeAttachY=_attachment$split2[0];changeAttachX=_attachment$split2[1]}else{changeAttachX=changeAttachY=attachment}var bounds=getBoundingRect(_this,to);if(changeAttachY==="target"||changeAttachY==="both"){if(top<bounds[1]&&tAttachment.top==="top"){top+=targetHeight;tAttachment.top="bottom"}if(top+height>bounds[3]&&tAttachment.top==="bottom"){top-=targetHeight;tAttachment.top="top"}}if(changeAttachY==="together"){if(tAttachment.top==="top"){if(eAttachment.top==="bottom"&&top<bounds[1]){top+=targetHeight;tAttachment.top="bottom";top+=height;eAttachment.top="top"}else if(eAttachment.top==="top"&&top+height>bounds[3]&&top-(height-targetHeight)>=bounds[1]){top-=height-targetHeight;tAttachment.top="bottom";eAttachment.top="bottom"}}if(tAttachment.top==="bottom"){if(eAttachment.top==="top"&&top+height>bounds[3]){top-=targetHeight;tAttachment.top="top";top-=height;eAttachment.top="bottom"}else if(eAttachment.top==="bottom"&&top<bounds[1]&&top+(height*2-targetHeight)<=bounds[3]){top+=height-targetHeight;tAttachment.top="top";eAttachment.top="top"}}if(tAttachment.top==="middle"){if(top+height>bounds[3]&&eAttachment.top==="top"){top-=height;eAttachment.top="bottom"}else if(top<bounds[1]&&eAttachment.top==="bottom"){top+=height;eAttachment.top="top"}}}if(changeAttachX==="target"||changeAttachX==="both"){if(left<bounds[0]&&tAttachment.left==="left"){left+=targetWidth;tAttachment.left="right"}if(left+width>bounds[2]&&tAttachment.left==="right"){left-=targetWidth;tAttachment.left="left"}}if(changeAttachX==="together"){if(left<bounds[0]&&tAttachment.left==="left"){if(eAttachment.left==="right"){left+=targetWidth;tAttachment.left="right";left+=width;eAttachment.left="left"}else if(eAttachment.left==="left"){left+=targetWidth;tAttachment.left="right";left-=width;eAttachment.left="right"}}else if(left+width>bounds[2]&&tAttachment.left==="right"){if(eAttachment.left==="left"){left-=targetWidth;tAttachment.left="left";left-=width;eAttachment.left="right"}else if(eAttachment.left==="right"){left-=targetWidth;tAttachment.left="left";left+=width;eAttachment.left="left"}}else if(tAttachment.left==="center"){if(left+width>bounds[2]&&eAttachment.left==="left"){left-=width;eAttachment.left="right"}else if(left<bounds[0]&&eAttachment.left==="right"){left+=width;eAttachment.left="left"}}}if(changeAttachY==="element"||changeAttachY==="both"){if(top<bounds[1]&&eAttachment.top==="bottom"){top+=height;eAttachment.top="top"}if(top+height>bounds[3]&&eAttachment.top==="top"){top-=height;eAttachment.top="bottom"}}if(changeAttachX==="element"||changeAttachX==="both"){if(left<bounds[0]){if(eAttachment.left==="right"){left+=width;eAttachment.left="left"}else if(eAttachment.left==="center"){left+=width/2;eAttachment.left="left"}}if(left+width>bounds[2]){if(eAttachment.left==="left"){left-=width;eAttachment.left="right"}else if(eAttachment.left==="center"){left-=width/2;eAttachment.left="right"}}}if(typeof pin==="string"){pin=pin.split(",").map(function(p){return p.trim()})}else if(pin===true){pin=["top","left","right","bottom"]}pin=pin||[];var pinned=[];var oob=[];if(top<bounds[1]){if(pin.indexOf("top")>=0){top=bounds[1];pinned.push("top")}else{oob.push("top")}}if(top+height>bounds[3]){if(pin.indexOf("bottom")>=0){top=bounds[3]-height;pinned.push("bottom")}else{oob.push("bottom")}}if(left<bounds[0]){if(pin.indexOf("left")>=0){left=bounds[0];pinned.push("left")}else{oob.push("left")}}if(left+width>bounds[2]){if(pin.indexOf("right")>=0){left=bounds[2]-width;pinned.push("right")}else{oob.push("right")}}if(pinned.length){var pinnedClass=void 0;if(typeof _this.options.pinnedClass!=="undefined"){pinnedClass=_this.options.pinnedClass}else{pinnedClass=_this.getClass("pinned")}addClasses.push(pinnedClass);pinned.forEach(function(side){addClasses.push(pinnedClass+"-"+side)})}if(oob.length){var oobClass=void 0;if(typeof _this.options.outOfBoundsClass!=="undefined"){oobClass=_this.options.outOfBoundsClass}else{oobClass=_this.getClass("out-of-bounds")}addClasses.push(oobClass);oob.forEach(function(side){addClasses.push(oobClass+"-"+side)})}if(pinned.indexOf("left")>=0||pinned.indexOf("right")>=0){eAttachment.left=tAttachment.left=false}if(pinned.indexOf("top")>=0||pinned.indexOf("bottom")>=0){eAttachment.top=tAttachment.top=false}if(tAttachment.top!==targetAttachment.top||tAttachment.left!==targetAttachment.left||eAttachment.top!==_this.attachment.top||eAttachment.left!==_this.attachment.left){_this.updateAttachClasses(eAttachment,tAttachment);_this.trigger("update",{attachment:eAttachment,targetAttachment:tAttachment})}});defer(function(){if(!(_this.options.addTargetClasses===false)){updateClasses(_this.target,addClasses,allClasses)}updateClasses(_this.element,addClasses,allClasses)});return{top:top,left:left}}});